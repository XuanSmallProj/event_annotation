# 标注工具

## 环境
当前目录下有含MultiSports标注信息的`match_matched_clips.csv`文件，并且有`dataset/annotate`文件夹。

依赖：PySide6,panda,numpy,cv2

## 标注说明

### 标签
标签设置信息存储在`event.json`文件中。标签分为“变化事件”和“镜头情况”两类，“变化事件”不允许重叠。每个标签属于"shot"或者"interval"，"shot"表示该标签对应一个时间戳，而"interval"表示标签对应一段时间。目前仅有“视角切换”事件属于“shot”类。

注意事项：
1. 最终标注中标注的区间的并集应该覆盖整段视频。
2. 变化事件不允许重叠。

## 标注工具使用说明
需要在项目目录下新建`dataset`文件夹，事件标签放在`dataset/annotate_event`下。

标签文件名为：`<video_name>.txt`，每个标签为一行，格式为`标签名,起始帧,终止帧`。

准备好相关环境之后，使用`python main.py`即可启动标注工具。

### 操作
空格：暂停/播放

playrate：倍速播放

A/D：暂停时候进行后退/前进，连续按键会加速

1/2/3/4/5/6: 1、0.1、0.3、0.5、4、8倍速

## 视频截取工具使用说明
视频截取工具能够将之前标注的视频片段从原视频截取出来。

使用之前，将原来的完整视频放在`dataset/`目录下，将原来的视频标注放在`dataset/annotate`目录下（注意备份），并且新建`dataset/parts`目录。

使用`python operations.py`即可启动视频截取功能，它会将`dataset`目录下的视频根据`dataset/annotate`目录下的标注进行截取，截取的视频保存在`dataset/parts`目录下，命名规则为`<video_name>_<id>.mp4`，`id`表示该片段是从这个视频中截取的第`id`个子片段。

在截取完毕之后，工具会在项目目录下新建`extract.json`文件，里面保存了截取的片段在原视频中的起始和终止时间。

### 已知问题
如果在截取过程中退出程序，可能造成截取的片段不完整。
